<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Roles de Cuadrillas Alsek</title>

  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    }

    body {
      min-height: 100vh;
      background: radial-gradient(circle at top left, #00ff9d 0, #001a13 40%, #000c0a 100%);
      color: #e6ffe6;
      padding: 24px;
    }

    .app-container {
      max-width: 1200px;
      margin: 0 auto;
    }

    .card {
      background: linear-gradient(145deg, #001d14, #00110d);
      border-radius: 18px;
      border: 1px solid #00ff9d55;
      box-shadow: 0 0 18px #00ff9d33;
      padding: 18px 22px;
    }

    .header-card {
      margin-bottom: 18px;
      background: linear-gradient(90deg, #00ff9d, #00d47a, #39ff14);
      color: #012012;
      border-radius: 18px;
      padding: 18px 24px;
      box-shadow: 0 0 25px #00ff9d55;
    }

    .header-title {
      font-size: 26px;
      font-weight: 800;
      text-align: center;
      text-shadow: 0 1px 2px #00000066;
    }

    .header-subtitle {
      text-align: center;
      font-size: 14px;
      font-weight: 600;
      margin-top: 4px;
      text-transform: capitalize;
    }

    .toolbar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
      gap: 8px;
    }

    .toolbar-middle {
      text-align: center;
      flex: 1;
    }

    .badge-week {
      display: inline-block;
      padding: 6px 14px;
      border-radius: 999px;
      background: #e5d9ff;
      color: #4a148c;
      font-weight: 700;
      font-size: 15px;
      box-shadow: 0 0 10px #9c27b060;
      margin-bottom: 2px;
    }

    /* NUEVO: mes y año debajo de la semana */
    .badge-month-year {
      font-size: 11px;
      color: #c8f6ff;
      text-transform: capitalize;
      text-shadow: 0 0 6px rgba(0, 255, 255, 0.35);
    }

    .btn {
      border: none;
      outline: none;
      cursor: pointer;
      font-size: 13px;
      font-weight: 700;
      padding: 7px 14px;
      border-radius: 999px;
      transition: all 0.18s ease-out;
      white-space: nowrap;
    }

    .btn-nav {
      background: #ffffff;
      color: #05633b;
      box-shadow: 0 0 10px #00ff9d55;
    }

    .btn-nav:hover {
      transform: translateY(-1px);
      box-shadow: 0 0 16px #00ff9d88;
    }

    .btn-main {
      background: linear-gradient(135deg, #00ff9d, #39ff14);
      color: #002013;
      box-shadow: 0 0 14px #00ff9d80;
    }

    .btn-main:hover {
      filter: brightness(1.05);
      transform: translateY(-1px);
      box-shadow: 0 0 18px #00ff9db3;
    }

    .btn-danger {
      background: linear-gradient(135deg, #ff1744, #ff4569);
      color: #fff;
      box-shadow: 0 0 14px #ff174480;
    }

    .btn-danger:hover {
      filter: brightness(1.05);
      transform: translateY(-1px);
      box-shadow: 0 0 18px #ff1744b3;
    }

    .btn-secondary {
      background: linear-gradient(135deg, #00d47a, #00ff9d);
      color: #012012;
      box-shadow: 0 0 10px #00ff9d66;
    }

    .btn-secondary:hover {
      filter: brightness(1.05);
      transform: translateY(-1px);
      box-shadow: 0 0 14px #00ff9d99;
    }

    .table-wrapper {
      overflow-x: auto;
      border-radius: 14px;
      border: 1px solid #00ff9d40;
      background: #000f0c;
      box-shadow: inset 0 0 10px #00ff9d22;
      margin-bottom: 16px;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 13px;
      color: #f4fff8;
    }

    thead {
      background: linear-gradient(90deg, #00b36b, #00ff9d);
      color: #002013;
    }

    th, td {
      border: 1px solid #003326;
      padding: 6px 8px;
      text-align: center;
    }

    th:first-child, td:first-child {
      text-align: left;
    }

    th .day-name {
      font-weight: 700;
      font-size: 13px;
    }

    th .day-number {
      font-size: 11px;
      font-weight: 600;
      opacity: 0.9;
    }

    tbody tr:nth-child(even) {
      background: #001713;
    }

    tbody tr:nth-child(odd) {
      background: #00100d;
    }

    tbody tr:hover {
      background: #00241a;
    }

    .col-cuadrilla {
      background: linear-gradient(90deg, #003321, #00492e);
      font-weight: 600;
      color: #b9ffe0;
      position: sticky;
      left: 0;
      z-index: 1;
    }

    .input-name {
      width: 100%;
      background: #000f0c;
      border-radius: 8px;
      border: 1px solid #00ff9d66;
      padding: 4px 6px;
      color: #e6ffe6;
      font-size: 12px;
    }

    .input-name:focus {
      outline: none;
      border-color: #00ff9d;
      box-shadow: 0 0 8px #00ff9d88;
    }

    /* Celdas de turno, versión neón */
    .turno-guardia {
      background: #ff1744;
      color: #ffffff;
      font-weight: 700;
      text-shadow: 0 1px 1px #00000088;
    }

    .turno-diurno {
      background: #ffe844;
      color: #332b00;
      font-weight: 600;
    }

    .turno-madrugador {
      background: #c77dff;
      color: #1c0033;
      font-weight: 700;
    }

    .turno-descanso {
      background: #4dabf7;
      color: #012033;
      font-weight: 600;
    }

    .legend-card {
      background: #00110d;
      border-radius: 14px;
      border: 1px solid #00ff9d55;
      padding: 12px 14px;
      box-shadow: 0 0 14px #00ff9d33;
    }

    .legend-title {
      font-weight: 700;
      font-size: 14px;
      margin-bottom: 6px;
    }

    .legend-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
      gap: 8px;
      font-size: 12px;
    }

    .legend-item {
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .legend-swatch {
      width: 14px;
      height: 14px;
      border-radius: 4px;
      box-shadow: 0 0 6px #00000088;
      border: 1px solid #00000055;
    }

    @media (max-width: 768px) {
      .toolbar {
        flex-direction: column;
        align-items: stretch;
      }
      .toolbar-middle {
        order: -1;
        margin-bottom: 8px;
      }
    }
  </style>

  <!-- React + ReactDOM + Babel -->
  <script src="https://unpkg.com/react@17/umd/react.development.js" crossorigin></script>
  <script src="https://unpkg.com/react-dom@17/umd/react-dom.development.js" crossorigin></script>
  <script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState } = React;

    const PATTERNS = [
      ['DESCANSO', 'DIURNO',  'DIURNO',  'DIURNO',  'DIURNO',  'DIURNO',  'GUARDIA'],
      ['DIURNO',   'DIURNO',  'DIURNO',  'DIURNO',  'DIURNO',  'DESCANSO','DIURNO'],
      ['DIURNO',   'DIURNO',  'DIURNO',  'DIURNO',  'DIURNO',  'DIURNO',  'DESCANSO'],
      ['DIURNO',   'DIURNO',  'DIURNO',  'DIURNO',  'DIURNO',  'GUARDIA', 'DESCANSO'],
      ['GUARDIA',  'GUARDIA', 'GUARDIA', 'GUARDIA', 'GUARDIA', 'DESCANSO','DIURNO'],
      ['GUARDIA',  'GUARDIA', 'GUARDIA', 'GUARDIA', 'GUARDIA', 'DESCANSO','MADRUGADOR'],
      ['GUARDIA',  'GUARDIA', 'GUARDIA', 'GUARDIA', 'GUARDIA', 'GUARDIA', 'DESCANSO'],
      ['MADRUGADOR','MADRUGADOR','MADRUGADOR','MADRUGADOR','MADRUGADOR','DESCANSO','GUARDIA']
    ];

    const WEEK_CYCLE = [
      [5, 6, 3, 7, 1, 0, 2],
      [3, 7, 1, 0, 2, 5, 6],
      [1, 0, 2, 4, 6, 3, 7],
      [2, 5, 6, 3, 7, 1, 0],
      [6, 3, 7, 1, 0, 2, 5],
      [7, 1, 0, 2, 5, 6, 3],
      [0, 2, 5, 6, 3, 7, 1]
    ];

    const SEMANA_BASE = 48;
    const ANO_BASE = 2025;

    function calcularDiferenciaSemanas(semana, ano) {
      return (ano - ANO_BASE) * 52 + (semana - SEMANA_BASE);
    }

    function getFechaLunes(semana, ano) {
      const base = new Date(2025, 10, 24);
      const diff = calcularDiferenciaSemanas(semana, ano);
      const fecha = new Date(base);
      fecha.setDate(fecha.getDate() + diff * 7);
      return fecha;
    }

    function getDiaMes(semana, ano, offsetDia) {
      const lunes = getFechaLunes(semana, ano);
      const fecha = new Date(lunes);
      fecha.setDate(fecha.getDate() + offsetDia);
      return fecha.getDate();
    }

    function getMesAnoTexto(semana, ano) {
      const lunes = getFechaLunes(semana, ano);
      return lunes.toLocaleDateString('es-MX', { month: 'long', year: 'numeric' });
    }

    function getTurnoSemana(idxCuadrilla, idxDia, semana, ano) {
      const diff = calcularDiferenciaSemanas(semana, ano);
      const ciclo = ((diff % 7) + 7) % 7;
      const patternIndex = WEEK_CYCLE[ciclo][idxCuadrilla];
      const pattern = PATTERNS[patternIndex];
      return pattern[idxDia];
    }

    function SistemaRolCuadrillas() {
      const [numeroSemana, setNumeroSemana] = useState(48);
      const [ano, setAno] = useState(2025);
      const [editando, setEditando] = useState(false);
      const [cuadrillas, setCuadrillas] = useState([
        'Alejandro Sevilla',
        'Agustin Gonzalez',
        'Antonio Diaz',
        'Alejandro Garcia',
        'luis Casillas',
        'Raul Diaz',
        'Jaime Granilla'
      ]);

      const dias = ['L', 'M', 'Mi', 'J', 'V', 'S', 'D'];

      const handleNombreChange = (index, nuevoNombre) => {
        const nuevas = [...cuadrillas];
        nuevas[index] = nuevoNombre;
        setCuadrillas(nuevas);
      };

      const navegarSemana = (direccion) => {
        let nuevaSemana = numeroSemana + direccion;
        let nuevoAno = ano;
        if (nuevaSemana > 52) {
          nuevaSemana = 1;
          nuevoAno = ano + 1;
        } else if (nuevaSemana < 1) {
          nuevaSemana = 52;
          nuevoAno = ano - 1;
        }
        setNumeroSemana(nuevaSemana);
        setAno(nuevoAno);
      };

      const irSemanaActual = () => {
        const hoy = new Date();
        const inicioAno = new Date(hoy.getFullYear(), 0, 1);
        const msPorDia = 24 * 60 * 60 * 1000;
        const diasTranscurridos = Math.floor((hoy - inicioAno) / msPorDia);
        const semanaActual = Math.ceil((diasTranscurridos + inicioAno.getDay() + 1) / 7);
        setNumeroSemana(semanaActual);
        setAno(hoy.getFullYear());
      };

      return (
        <div className="app-container">
          <div className="header-card">
            <div className="header-title">Roles de Cuadrillas Alsek</div>
            <div className="header-subtitle">
              {getMesAnoTexto(numeroSemana, ano)}
            </div>
          </div>

          <div className="card" style={{ marginBottom: '14px' }}>
            <div className="toolbar">
              <button className="btn btn-nav" onClick={() => navegarSemana(-1)}>
                &larr; Anterior
              </button>

              <div className="toolbar-middle">
                <div className="badge-week">Semana {numeroSemana}</div>
                {/* Aquí va ahora el mes y año de la semana seleccionada */}
                <div className="badge-month-year">
                  {getMesAnoTexto(numeroSemana, ano)}
                </div>
              </div>

              <button className="btn btn-nav" onClick={() => navegarSemana(1)}>
                Siguiente &rarr;
              </button>
            </div>

            <div className="toolbar">
              <button
                className={`btn ${editando ? 'btn-danger' : 'btn-secondary'}`}
                onClick={() => setEditando(!editando)}
              >
                {editando ? 'Guardar nombres' : 'Editar nombres'}
              </button>

              <button className="btn btn-main" onClick={irSemanaActual}>
                Semana actual
              </button>
            </div>
          </div>

          <div className="table-wrapper">
            <table>
              <thead>
                <tr>
                  <th>Cuadrilla</th>
                  {dias.map((dia, idx) => (
                    <th key={idx}>
                      <div className="day-name">{dia}</div>
                      <div className="day-number">
                        {getDiaMes(numeroSemana, ano, idx)}
                      </div>
                    </th>
                  ))}
                </tr>
              </thead>
              <tbody>
                {cuadrillas.map((nom, i) => (
                  <tr key={i}>
                    <td className="col-cuadrilla">
                      {editando ? (
                        <input
                          value={nom}
                          onChange={e => handleNombreChange(i, e.target.value)}
                          className="input-name"
                        />
                      ) : (
                        nom
                      )}
                    </td>
                    {dias.map((_, diaIdx) => {
                      const turno = getTurnoSemana(i, diaIdx, numeroSemana, ano);
                      let clase = '';
                      let texto = '';

                      if (turno === 'GUARDIA') {
                        clase = 'turno-guardia';
                        texto = 'Guardia';
                      } else if (turno === 'DIURNO') {
                        clase = 'turno-diurno';
                        texto = 'Diurno';
                      } else if (turno === 'DESCANSO') {
                        clase = 'turno-descanso';
                        texto = 'Descanso';
                      } else if (turno === 'MADRUGADOR') {
                        clase = 'turno-madrugador';
                        texto = 'Madrugador';
                      }

                      return (
                        <td key={diaIdx} className={clase}>
                          {texto}
                        </td>
                      );
                    })}
                  </tr>
                ))}
              </tbody>
            </table>
          </div>

          <div className="legend-card">
            <div className="legend-title">Horario de Turnos</div>
            <div className="legend-grid">
              <div className="legend-item">
                <span className="legend-swatch" style={{ background: '#ff1744' }}></span>
                Guardia (06:00 pm – 09:00 am)
              </div>
              <div className="legend-item">
                <span className="legend-swatch" style={{ background: '#ffe844' }}></span>
                Diurno (09:00 am – 06:00 pm)
              </div>
              <div className="legend-item">
                <span className="legend-swatch" style={{ background: '#c77dff' }}></span>
                Madrugador (06:00 am – 03:00 pm)
              </div>
              <div className="legend-item">
                <span className="legend-swatch" style={{ background: '#4dabf7' }}></span>
                Descanso
              </div>
            </div>
          </div>
        </div>
      );
    }

    ReactDOM.render(<SistemaRolCuadrillas />, document.getElementById('root'));
  </script>
</body>
</html>

